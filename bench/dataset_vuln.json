{
  "repo_url": "https://github.com/ollama/ollama.git",
  "commit": "26214125e86ac1d4512dff68c983137589cfddbf",
  "queries": [
    {
      "id": "3b866a1d-8de9-4999-bbf3-651c1eb6ec5e",
      "name": "Unsafe Evaluation Functions",
      "filter_prompt": "The code snippet contains a function call that dynamically executes code or system commands. Examples include Python's `eval()`, `exec()`, or functions like `os.system()`, `subprocess.run()` (especially with `shell=True`), `subprocess.call()` (with `shell=True`), or `popen()`. The critical feature is that the string representing the code or command to be executed is not a hardcoded literal; instead, it's derived from a variable, function argument, string concatenation/formatting, or an external source such as user input, network request, or LLM output.",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "start",
          "type": "function",
          "file_path": "app/lifecycle/server.go",
          "start_line": 52,
          "end_line": 132
        },
        {
          "name": "SpawnServer",
          "type": "function",
          "file_path": "app/lifecycle/server.go",
          "start_line": 134,
          "end_line": 171
        },
        {
          "name": "ShowLogs",
          "type": "function",
          "file_path": "app/lifecycle/logging_windows.go",
          "start_line": 10,
          "end_line": 19
        },
        {
          "name": "DoUpgrade",
          "type": "function",
          "file_path": "app/lifecycle/updater_windows.go",
          "start_line": 13,
          "end_line": 74
        },
        {
          "name": "server",
          "type": "function",
          "file_path": "macapp/src/index.ts",
          "start_line": 136,
          "end_line": 152
        },
        {
          "name": "install",
          "type": "function",
          "file_path": "macapp/src/install.ts",
          "start_line": 15,
          "end_line": 21
        },
        {
          "name": "startApp",
          "type": "function",
          "file_path": "cmd/start_darwin.go",
          "start_line": 13,
          "end_line": 31
        },
        {
          "name": "startApp",
          "type": "function",
          "file_path": "cmd/start_windows.go",
          "start_line": 24,
          "end_line": 65
        }
      ],
      "cost": 0.9398831999999998
    },
    {
      "id": "b2565e7b-dacc-44e5-9817-a31898326bc1",
      "name": "Pickle/Cloudpickle Deserialization",
      "filter_prompt": "This code snippet deserializes data using functions from Python's `pickle` or `cloudpickle` libraries, such as `load()` or `loads()`. The input data for the deserialization operation is not a hardcoded literal.",
      "subdirs_or_files": [
        "/"
      ],
      "cost": 0.9272420000000002
    },
    {
      "id": "a8a337fc-4a32-4bf9-b98c-4b30a666352a",
      "name": "Magic Bytes File Type Manipulation",
      "filter_prompt": "This code snippet implements logic to determine or validate a file's type by reading and analyzing its initial bytes (e.g., magic bytes, file signature, or header). This is often part of a file upload handling mechanism or file processing pipeline where verifying the actual content type based on its leading bytes is critical.",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "DetectContentType",
          "type": "function",
          "file_path": "fs/ggml/ggml.go",
          "start_line": 427,
          "end_line": 442
        },
        {
          "name": "Open",
          "type": "function",
          "file_path": "fs/gguf/gguf.go",
          "start_line": 47,
          "end_line": 91
        },
        {
          "name": "parseSafetensors",
          "type": "function",
          "file_path": "convert/reader_safetensors.go",
          "start_line": 26,
          "end_line": 81
        },
        {
          "name": "detectModelTypeFromFiles",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 189,
          "end_line": 225
        },
        {
          "name": "ggufLayers",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 478,
          "end_line": 526
        },
        {
          "name": "detectContentType",
          "type": "function",
          "file_path": "server/model.go",
          "start_line": 112,
          "end_line": 127
        },
        {
          "name": "stbi_is_hdr_from_callbacks",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 478,
          "end_line": 478
        },
        {
          "name": "stbi_is_hdr_from_memory",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 479,
          "end_line": 479
        },
        {
          "name": "stbi_is_hdr",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 481,
          "end_line": 481
        },
        {
          "name": "stbi_is_hdr_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 482,
          "end_line": 482
        },
        {
          "name": "stbi_info_from_memory",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 494,
          "end_line": 494
        },
        {
          "name": "stbi_info_from_callbacks",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 495,
          "end_line": 495
        },
        {
          "name": "stbi_is_16_bit_from_memory",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 496,
          "end_line": 496
        },
        {
          "name": "stbi_is_16_bit_from_callbacks",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 497,
          "end_line": 497
        },
        {
          "name": "stbi_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 500,
          "end_line": 500
        },
        {
          "name": "stbi_info_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 501,
          "end_line": 501
        },
        {
          "name": "stbi_is_16_bit",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 502,
          "end_line": 502
        },
        {
          "name": "stbi_is_16_bit_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 503,
          "end_line": 503
        },
        {
          "name": "stbi__jpeg_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 909,
          "end_line": 909
        },
        {
          "name": "stbi__jpeg_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 911,
          "end_line": 911
        },
        {
          "name": "stbi__png_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 915,
          "end_line": 915
        },
        {
          "name": "stbi__png_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 917,
          "end_line": 917
        },
        {
          "name": "stbi__png_is16",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 918,
          "end_line": 918
        },
        {
          "name": "stbi__bmp_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 922,
          "end_line": 922
        },
        {
          "name": "stbi__bmp_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 924,
          "end_line": 924
        },
        {
          "name": "stbi__tga_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 928,
          "end_line": 928
        },
        {
          "name": "stbi__tga_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 930,
          "end_line": 930
        },
        {
          "name": "stbi__psd_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 934,
          "end_line": 934
        },
        {
          "name": "stbi__psd_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 936,
          "end_line": 936
        },
        {
          "name": "stbi__psd_is16",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 937,
          "end_line": 937
        },
        {
          "name": "stbi__hdr_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 941,
          "end_line": 941
        },
        {
          "name": "stbi__hdr_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 943,
          "end_line": 943
        },
        {
          "name": "stbi__pic_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 947,
          "end_line": 947
        },
        {
          "name": "stbi__pic_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 949,
          "end_line": 949
        },
        {
          "name": "stbi__gif_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 953,
          "end_line": 953
        },
        {
          "name": "stbi__gif_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 956,
          "end_line": 956
        },
        {
          "name": "stbi__pnm_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 960,
          "end_line": 960
        },
        {
          "name": "stbi__pnm_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 962,
          "end_line": 962
        },
        {
          "name": "stbi__pnm_is16",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 963,
          "end_line": 963
        },
        {
          "name": "stbi_is_hdr_from_memory",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1517,
          "end_line": 1517
        },
        {
          "name": "stbi_is_hdr",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1531,
          "end_line": 1531
        },
        {
          "name": "stbi_is_hdr_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1542,
          "end_line": 1542
        },
        {
          "name": "stbi_is_hdr_from_callbacks",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1559,
          "end_line": 1559
        },
        {
          "name": "stbi__get_marker",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 2919,
          "end_line": 2919
        },
        {
          "name": "stbi__process_marker",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 3099,
          "end_line": 3099
        },
        {
          "name": "stbi__process_scan_header",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 3203,
          "end_line": 3203
        },
        {
          "name": "stbi__process_frame_header",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 3264,
          "end_line": 3264
        },
        {
          "name": "stbi__decode_jpeg_header",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 3365,
          "end_line": 3365
        },
        {
          "name": "stbi__jpeg_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 4042,
          "end_line": 4042
        },
        {
          "name": "stbi__jpeg_info_raw",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 4056,
          "end_line": 4056
        },
        {
          "name": "stbi__jpeg_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 4068,
          "end_line": 4068
        },
        {
          "name": "stbi__check_png_header",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 4621,
          "end_line": 4621
        },
        {
          "name": "stbi__parse_png_file",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5078,
          "end_line": 5078
        },
        {
          "name": "stbi__png_load",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5295,
          "end_line": 5295
        },
        {
          "name": "stbi__png_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5302,
          "end_line": 5302
        },
        {
          "name": "stbi__bmp_test_raw",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5346,
          "end_line": 5346
        },
        {
          "name": "stbi__bmp_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5361,
          "end_line": 5361
        },
        {
          "name": "stbi__bmp_parse_header",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5448,
          "end_line": 5448
        },
        {
          "name": "stbi__tga_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5755,
          "end_line": 5755
        },
        {
          "name": "stbi__tga_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 5820,
          "end_line": 5820
        },
        {
          "name": "stbi__psd_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 6081,
          "end_line": 6081
        },
        {
          "name": "stbi__pic_is4",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 6336,
          "end_line": 6336
        },
        {
          "name": "stbi__pic_test_core",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 6346,
          "end_line": 6346
        },
        {
          "name": "stbi__pic_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 6541,
          "end_line": 6541
        },
        {
          "name": "stbi__gif_test_raw",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 6580,
          "end_line": 6580
        },
        {
          "name": "stbi__gif_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 6590,
          "end_line": 6590
        },
        {
          "name": "stbi__gif_header",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 6608,
          "end_line": 6608
        },
        {
          "name": "stbi__hdr_test_core",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7087,
          "end_line": 7087
        },
        {
          "name": "stbi__hdr_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7097,
          "end_line": 7097
        },
        {
          "name": "stbi__pnm_test",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7494,
          "end_line": 7494
        },
        {
          "name": "stbi_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7691,
          "end_line": 7691
        },
        {
          "name": "stbi_info_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7701,
          "end_line": 7701
        },
        {
          "name": "stbi_is_16_bit",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7712,
          "end_line": 7712
        },
        {
          "name": "stbi_is_16_bit_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7722,
          "end_line": 7722
        },
        {
          "name": "stbi_info_from_memory",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7734,
          "end_line": 7734
        },
        {
          "name": "stbi_info_from_callbacks",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7741,
          "end_line": 7741
        },
        {
          "name": "stbi_is_16_bit_from_memory",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7748,
          "end_line": 7748
        },
        {
          "name": "stbi_is_16_bit_from_callbacks",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7755,
          "end_line": 7755
        },
        {
          "name": "is_audio_file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd-helper.cpp",
          "start_line": 349,
          "end_line": 349
        },
        {
          "name": "NewTextProcessor",
          "type": "function",
          "file_path": "model/model.go",
          "start_line": 125,
          "end_line": 136
        },
        {
          "name": "EncodeMultimodal",
          "type": "function",
          "file_path": "model/models/mistral3/model.go",
          "start_line": 102,
          "end_line": 129
        },
        {
          "name": "projectorMemoryRequirements",
          "type": "function",
          "file_path": "llm/memory.go",
          "start_line": 483,
          "end_line": 500
        },
        {
          "name": "filesForModel",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 221,
          "end_line": 310
        },
        {
          "name": "getImageData",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 591,
          "end_line": 633
        }
      ],
      "cost": 0.9129667999999966
    },
    {
      "id": "9011537d-3f3a-4587-9500-068c453194f9",
      "name": "Shell Command Execution",
      "filter_prompt": "This code snippet executes a shell command, system command, an external program, or evaluates a string as code. This is often done using functions like `os.system`, `subprocess.call`, `subprocess.run` (especially with `shell=True`), `subprocess.Popen` (especially with `shell=True`), `commands.getoutput`, `Runtime.getRuntime().exec`, `ProcessBuilder`, `php.system`, `php.exec`, `php.shell_exec`, `php.passthru`, `php.popen`, PHP backticks (` `), `Node.child_process.exec`, `Node.child_process.execSync`, `eval`, `exec`, `ScriptEngine.eval()`, `execCommand`, `Perl.system`, `Ruby.system`, `Ruby.exec`, Ruby backticks (``), `Go.os/exec.Command`, etc. The command string, arguments to the command, or the string being evaluated as code, are derived from variables, function parameters, or other dynamic sources, rather than being solely hardcoded string literals.",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "getCmd",
          "type": "function",
          "file_path": "app/lifecycle/server_windows.go",
          "start_line": 12,
          "end_line": 20
        },
        {
          "name": "getCmd",
          "type": "function",
          "file_path": "app/lifecycle/server_unix.go",
          "start_line": 14,
          "end_line": 16
        },
        {
          "name": "GetStarted",
          "type": "function",
          "file_path": "app/lifecycle/getstarted_windows.go",
          "start_line": 12,
          "end_line": 43
        },
        {
          "name": "start",
          "type": "function",
          "file_path": "app/lifecycle/server.go",
          "start_line": 52,
          "end_line": 132
        },
        {
          "name": "SpawnServer",
          "type": "function",
          "file_path": "app/lifecycle/server.go",
          "start_line": 134,
          "end_line": 171
        },
        {
          "name": "ShowLogs",
          "type": "function",
          "file_path": "app/lifecycle/logging_windows.go",
          "start_line": 10,
          "end_line": 19
        },
        {
          "name": "DoUpgrade",
          "type": "function",
          "file_path": "app/lifecycle/updater_windows.go",
          "start_line": 13,
          "end_line": 74
        },
        {
          "name": "server",
          "type": "function",
          "file_path": "macapp/src/index.ts",
          "start_line": 136,
          "end_line": 152
        },
        {
          "name": "install",
          "type": "function",
          "file_path": "macapp/src/install.ts",
          "start_line": 15,
          "end_line": 21
        },
        {
          "name": "startApp",
          "type": "function",
          "file_path": "cmd/start_darwin.go",
          "start_line": 13,
          "end_line": 31
        },
        {
          "name": "startApp",
          "type": "function",
          "file_path": "cmd/start_windows.go",
          "start_line": 24,
          "end_line": 65
        },
        {
          "name": "os/exec",
          "type": "dependency",
          "file_path": "cmd/start_windows.go",
          "start_line": 9,
          "end_line": 9
        }
      ],
      "cost": 0.9491599999999996
    },
    {
      "id": "ab624bd9-92e7-4f34-a2b4-02a914a78040",
      "name": "Command Injection in CLI Applications",
      "filter_prompt": "This code snippet executes operating system commands using functions like `os.system`, `subprocess.run`, `subprocess.Popen`, `subprocess.call`, `subprocess.check_output`, `commands.getoutput`, or `pty.spawn`. The command being executed is dynamically constructed using string operations (e.g., concatenation, f-strings, `.format()`) with variables that could hold data from external sources like command-line arguments or file content. Prioritize instances where `subprocess` functions are used with `shell=True` or where command components are assembled from non-literal string variables.",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "install",
          "type": "function",
          "file_path": "macapp/src/install.ts",
          "start_line": 15,
          "end_line": 21
        }
      ],
      "cost": 0.914192799999995
    },
    {
      "id": "1f7cc885-ad42-42a7-a051-0bb5cd97374f",
      "name": "Other Deserialization Mechanisms",
      "filter_prompt": "This code snippet performs deserialization of data using PyTorch's `torch.load()` (or similar model loading functions in AI/ML frameworks), Python's `shelve` module (e.g., `shelve.open()`, `shelf[key]`), or JDBC connection mechanisms (e.g., constructing connection URLs or using drivers). The deserialization is flagged if the input data (such as a model file path or content, data from a shelve file, or components of a JDBC URL) is not a hardcoded literal and could originate from an untrusted external source.",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "parseTorch",
          "type": "function",
          "file_path": "convert/reader_torch.go",
          "start_line": 12,
          "end_line": 39
        },
        {
          "name": "parseTensors",
          "type": "function",
          "file_path": "convert/reader.go",
          "start_line": 68,
          "end_line": 91
        },
        {
          "name": "GetManifest",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 253,
          "end_line": 273
        },
        {
          "name": "GetModel",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 275,
          "end_line": 373
        },
        {
          "name": "processPending",
          "type": "function",
          "file_path": "server/sched.go",
          "start_line": 131,
          "end_line": 258
        },
        {
          "name": "llama_model_load",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 87,
          "end_line": 87
        },
        {
          "name": "llama_model_load_from_file_impl",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 137,
          "end_line": 140
        },
        {
          "name": "llama_load_model_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 238,
          "end_line": 240
        },
        {
          "name": "llama_model_load_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 244,
          "end_line": 246
        },
        {
          "name": "llama_model_load_from_splits",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 251,
          "end_line": 254
        },
        {
          "name": "llama_model_load_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 414,
          "end_line": 416
        },
        {
          "name": "llama_model_load_from_splits",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 420,
          "end_line": 423
        },
        {
          "name": "llama_state_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 810,
          "end_line": 815
        },
        {
          "name": "DEPRECATED",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 816,
          "end_line": 822
        },
        {
          "name": "llama_load_session_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 816,
          "end_line": 821
        },
        {
          "name": "llama_state_seq_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 865,
          "end_line": 871
        },
        {
          "name": "GetModelArch",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 81,
          "end_line": 101
        },
        {
          "name": "LoadModelFromFile",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 227,
          "end_line": 262
        },
        {
          "name": "ApplyLoraFromFile",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 292,
          "end_line": 310
        },
        {
          "name": "NewMtmdContext",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 480,
          "end_line": 493
        },
        {
          "name": "NewTextProcessor",
          "type": "function",
          "file_path": "model/model.go",
          "start_line": 125,
          "end_line": 136
        },
        {
          "name": "projectorMemoryRequirements",
          "type": "function",
          "file_path": "llm/memory.go",
          "start_line": 483,
          "end_line": 500
        }
      ],
      "cost": 0.9663416000000034
    },
    {
      "id": "dbfd2d19-9e1a-4c1a-b1f1-79318deebb06",
      "name": "Path Traversal and File Operations",
      "filter_prompt": "Locate code snippets that perform file system operations (such as reading, writing, deleting, moving files or directories, extracting archives, or including files) or use file paths or names within system commands. Focus on cases where these file paths or names are derived from, or can be influenced by, external sources (e.g., user input, network data, API parameters, environment variables, or function arguments traceable to such sources) and where there is a potential lack of, or insufficient, sanitization or validation against path traversal techniques (e.g., sequences like '..', absolute paths, symbolic links, null bytes, or encoding tricks).",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "getStorePath",
          "type": "function",
          "file_path": "app/store/store_linux.go",
          "start_line": 8,
          "end_line": 16
        },
        {
          "name": "SetFirstTimeRun",
          "type": "function",
          "file_path": "app/store/store.go",
          "start_line": 43,
          "end_line": 51
        },
        {
          "name": "writeStore",
          "type": "function",
          "file_path": "app/store/store.go",
          "start_line": 71,
          "end_line": 97
        },
        {
          "name": "getStorePath",
          "type": "function",
          "file_path": "app/store/store_darwin.go",
          "start_line": 8,
          "end_line": 13
        },
        {
          "name": "getStorePath",
          "type": "function",
          "file_path": "app/store/store_windows.go",
          "start_line": 8,
          "end_line": 11
        },
        {
          "name": "rotateLogs",
          "type": "function",
          "file_path": "app/lifecycle/logging.go",
          "start_line": 35,
          "end_line": 62
        },
        {
          "name": "GetStarted",
          "type": "function",
          "file_path": "app/lifecycle/getstarted_windows.go",
          "start_line": 12,
          "end_line": 43
        },
        {
          "name": "DownloadNewRelease",
          "type": "function",
          "file_path": "app/lifecycle/updater.go",
          "start_line": 107,
          "end_line": 181
        },
        {
          "name": "install",
          "type": "function",
          "file_path": "macapp/src/install.ts",
          "start_line": 15,
          "end_line": 21
        },
        {
          "name": "Open",
          "type": "function",
          "file_path": "fs/gguf/gguf.go",
          "start_line": 47,
          "end_line": 91
        },
        {
          "name": "parseMore",
          "type": "function",
          "file_path": "convert/convert_bert.go",
          "start_line": 40,
          "end_line": 86
        },
        {
          "name": "parseTorch",
          "type": "function",
          "file_path": "convert/reader_torch.go",
          "start_line": 12,
          "end_line": 39
        },
        {
          "name": "parseTensors",
          "type": "function",
          "file_path": "convert/reader.go",
          "start_line": 68,
          "end_line": 91
        },
        {
          "name": "parseSafetensors",
          "type": "function",
          "file_path": "convert/reader_safetensors.go",
          "start_line": 26,
          "end_line": 81
        },
        {
          "name": "WriteTo",
          "type": "function",
          "file_path": "convert/reader_safetensors.go",
          "start_line": 121,
          "end_line": 205
        },
        {
          "name": "ConvertAdapter",
          "type": "function",
          "file_path": "convert/convert.go",
          "start_line": 118,
          "end_line": 154
        },
        {
          "name": "parseTokenizer",
          "type": "function",
          "file_path": "convert/tokenizer.go",
          "start_line": 36,
          "end_line": 203
        },
        {
          "name": "parseVocabularyFromTokenizer",
          "type": "function",
          "file_path": "convert/tokenizer.go",
          "start_line": 237,
          "end_line": 279
        },
        {
          "name": "Init",
          "type": "function",
          "file_path": "readline/history.go",
          "start_line": 40,
          "end_line": 81
        },
        {
          "name": "Save",
          "type": "function",
          "file_path": "readline/history.go",
          "start_line": 125,
          "end_line": 151
        },
        {
          "name": "Execute",
          "type": "function",
          "file_path": "runner/llamarunner/runner.go",
          "start_line": 850,
          "end_line": 907
        },
        {
          "name": "NewImageContext",
          "type": "function",
          "file_path": "runner/llamarunner/image.go",
          "start_line": 27,
          "end_line": 47
        },
        {
          "name": "GetManifest",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 253,
          "end_line": 273
        },
        {
          "name": "GetModel",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 275,
          "end_line": 373
        },
        {
          "name": "CopyModel",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 375,
          "end_line": 412
        },
        {
          "name": "PruneLayers",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 445,
          "end_line": 487
        },
        {
          "name": "PruneDirectory",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 489,
          "end_line": 520
        },
        {
          "name": "PullModel",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 571,
          "end_line": 675
        },
        {
          "name": "verifyBlob",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 849,
          "end_line": 867
        },
        {
          "name": "processPending",
          "type": "function",
          "file_path": "server/sched.go",
          "start_line": 131,
          "end_line": 258
        },
        {
          "name": "detectModelTypeFromFiles",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 189,
          "end_line": 225
        },
        {
          "name": "quantizeLayer",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 426,
          "end_line": 476
        },
        {
          "name": "ggufLayers",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 478,
          "end_line": 526
        },
        {
          "name": "setTemplate",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 543,
          "end_line": 560
        },
        {
          "name": "setSystem",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 562,
          "end_line": 573
        },
        {
          "name": "setLicense",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 575,
          "end_line": 583
        },
        {
          "name": "createLink",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 675,
          "end_line": 688
        },
        {
          "name": "copyFile",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 690,
          "end_line": 705
        },
        {
          "name": "GetManifestPath",
          "type": "function",
          "file_path": "server/modelpath.go",
          "start_line": 116,
          "end_line": 123
        },
        {
          "name": "GetBlobsPath",
          "type": "function",
          "file_path": "server/modelpath.go",
          "start_line": 125,
          "end_line": 146
        },
        {
          "name": "ParseNamedManifest",
          "type": "function",
          "file_path": "server/manifest.go",
          "start_line": 63,
          "end_line": 97
        },
        {
          "name": "WriteManifest",
          "type": "function",
          "file_path": "server/manifest.go",
          "start_line": 99,
          "end_line": 124
        },
        {
          "name": "readAndSum",
          "type": "function",
          "file_path": "server/internal/cache/blob/cache.go",
          "start_line": 98,
          "end_line": 114
        },
        {
          "name": "nameToPath",
          "type": "function",
          "file_path": "server/internal/cache/blob/cache.go",
          "start_line": 530,
          "end_line": 536
        },
        {
          "name": "absJoin",
          "type": "function",
          "file_path": "server/internal/cache/blob/cache.go",
          "start_line": 538,
          "end_line": 544
        },
        {
          "name": "handleDelete",
          "type": "function",
          "file_path": "server/internal/registry/server.go",
          "start_line": 230,
          "end_line": 249
        },
        {
          "name": "Name",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 103,
          "end_line": 107
        },
        {
          "name": "Prepare",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 126,
          "end_line": 181
        },
        {
          "name": "run",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 214,
          "end_line": 327
        },
        {
          "name": "readPart",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 400,
          "end_line": 414
        },
        {
          "name": "writePart",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 416,
          "end_line": 424
        },
        {
          "name": "parseFromModel",
          "type": "function",
          "file_path": "server/model.go",
          "start_line": 27,
          "end_line": 76
        },
        {
          "name": "NewLayerFromLayer",
          "type": "function",
          "file_path": "server/layer.go",
          "start_line": 67,
          "end_line": 89
        },
        {
          "name": "Open",
          "type": "function",
          "file_path": "server/layer.go",
          "start_line": 91,
          "end_line": 102
        },
        {
          "name": "Remove",
          "type": "function",
          "file_path": "server/layer.go",
          "start_line": 104,
          "end_line": 130
        },
        {
          "name": "common_log",
          "type": "class",
          "file_path": "llama/llama.cpp/common/log.cpp",
          "start_line": 108,
          "end_line": 344
        },
        {
          "name": "common_log.set_file",
          "type": "function",
          "file_path": "llama/llama.cpp/common/log.cpp",
          "start_line": 295,
          "end_line": 295
        },
        {
          "name": "common_log_set_file",
          "type": "function",
          "file_path": "llama/llama.cpp/common/log.cpp",
          "start_line": 379,
          "end_line": 379
        },
        {
          "name": "fs_validate_filename",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.cpp",
          "start_line": 700,
          "end_line": 700
        },
        {
          "name": "fs_create_directory_with_parents",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.cpp",
          "start_line": 789,
          "end_line": 789
        },
        {
          "name": "fs_get_cache_directory",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.cpp",
          "start_line": 865,
          "end_line": 865
        },
        {
          "name": "fs_get_cache_file",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.cpp",
          "start_line": 896,
          "end_line": 896
        },
        {
          "name": "fs_validate_filename",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.h",
          "start_line": 564,
          "end_line": 564
        },
        {
          "name": "fs_create_directory_with_parents",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.h",
          "start_line": 565,
          "end_line": 565
        },
        {
          "name": "common_init_from_params",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.h",
          "start_line": 582,
          "end_line": 582
        },
        {
          "name": "common_control_vector_load",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.h",
          "start_line": 687,
          "end_line": 687
        },
        {
          "name": "llama_adapter_lora_init_impl",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-adapter.cpp",
          "start_line": 148,
          "end_line": 148
        },
        {
          "name": "llama_adapter_lora_init",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-adapter.cpp",
          "start_line": 371,
          "end_line": 371
        },
        {
          "name": "state_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 1689,
          "end_line": 1689
        },
        {
          "name": "state_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 1732,
          "end_line": 1732
        },
        {
          "name": "state_seq_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 1749,
          "end_line": 1749
        },
        {
          "name": "state_seq_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 1792,
          "end_line": 1792
        },
        {
          "name": "llama_load_session_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2752,
          "end_line": 2752
        },
        {
          "name": "llama_save_session_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2757,
          "end_line": 2757
        },
        {
          "name": "llama_state_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2780,
          "end_line": 2780
        },
        {
          "name": "llama_state_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2791,
          "end_line": 2791
        },
        {
          "name": "llama_state_seq_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2818,
          "end_line": 2818
        },
        {
          "name": "llama_state_seq_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2829,
          "end_line": 2829
        },
        {
          "name": "ml",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-quant.cpp",
          "start_line": 599,
          "end_line": 599
        },
        {
          "name": "llama_model_quantize",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-quant.cpp",
          "start_line": 1073,
          "end_line": 1076
        },
        {
          "name": "impl",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-mmap.cpp",
          "start_line": 77,
          "end_line": 77
        },
        {
          "name": "impl",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-mmap.cpp",
          "start_line": 162,
          "end_line": 162
        },
        {
          "name": "llama_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-mmap.cpp",
          "start_line": 244,
          "end_line": 244
        },
        {
          "name": "llama_file",
          "type": "class",
          "file_path": "llama/llama.cpp/src/llama-mmap.h",
          "start_line": 15,
          "end_line": 35
        },
        {
          "name": "llama_model_load",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 87,
          "end_line": 87
        },
        {
          "name": "llama_model_load_from_file_impl",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 137,
          "end_line": 140
        },
        {
          "name": "llama_load_model_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 238,
          "end_line": 240
        },
        {
          "name": "llama_model_load_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 244,
          "end_line": 246
        },
        {
          "name": "llama_model_load_from_splits",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 251,
          "end_line": 254
        },
        {
          "name": "llama_model_save_to_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 266,
          "end_line": 266
        },
        {
          "name": "llama_split_path",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 312,
          "end_line": 312
        },
        {
          "name": "llama_split_prefix",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 320,
          "end_line": 320
        },
        {
          "name": "save",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-model-saver.cpp",
          "start_line": 279,
          "end_line": 279
        },
        {
          "name": "llama_context",
          "type": "class",
          "file_path": "llama/llama.cpp/src/llama-context.h",
          "start_line": 23,
          "end_line": 310
        },
        {
          "name": "stbi_load",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 427,
          "end_line": 427
        },
        {
          "name": "stbi_load_16",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 449,
          "end_line": 449
        },
        {
          "name": "stbi_loadf",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 462,
          "end_line": 462
        },
        {
          "name": "stbi_is_hdr",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 481,
          "end_line": 481
        },
        {
          "name": "stbi_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 500,
          "end_line": 500
        },
        {
          "name": "stbi_is_16_bit",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 502,
          "end_line": 502
        },
        {
          "name": "stbi__fopen",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1337,
          "end_line": 1337
        },
        {
          "name": "stbi_load",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1366,
          "end_line": 1366
        },
        {
          "name": "stbi_load_16",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1402,
          "end_line": 1402
        },
        {
          "name": "stbi_loadf",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1493,
          "end_line": 1493
        },
        {
          "name": "stbi_is_hdr",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 1531,
          "end_line": 1531
        },
        {
          "name": "stbi_info",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7691,
          "end_line": 7691
        },
        {
          "name": "stbi_is_16_bit",
          "type": "function",
          "file_path": "llama/llama.cpp/vendor/stb/stb_image.h",
          "start_line": 7712,
          "end_line": 7712
        },
        {
          "name": "mtmd_context",
          "type": "class",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd.cpp",
          "start_line": 107,
          "end_line": 357
        },
        {
          "name": "mtmd_context.mtmd_context",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd.cpp",
          "start_line": 145,
          "end_line": 147
        },
        {
          "name": "mtmd_init_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd.cpp",
          "start_line": 359,
          "end_line": 361
        },
        {
          "name": "clip_init",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.h",
          "start_line": 35,
          "end_line": 35
        },
        {
          "name": "clip_image_load_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.h",
          "start_line": 85,
          "end_line": 85
        },
        {
          "name": "mtmd_helper_bitmap_init_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd-helper.cpp",
          "start_line": 439,
          "end_line": 439
        },
        {
          "name": "mtmd_helper_bitmap_init_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd-helper.h",
          "start_line": 27,
          "end_line": 27
        },
        {
          "name": "clip_image_write_image_to_ppm",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 61,
          "end_line": 61
        },
        {
          "name": "file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 62,
          "end_line": 62
        },
        {
          "name": "clip_image_save_to_bmp",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 80,
          "end_line": 80
        },
        {
          "name": "file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 81,
          "end_line": 81
        },
        {
          "name": "clip_model_loader",
          "type": "class",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 2032,
          "end_line": 2776
        },
        {
          "name": "clip_model_loader.clip_model_loader",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 2044,
          "end_line": 2044
        },
        {
          "name": "clip_init",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 2778,
          "end_line": 2778
        },
        {
          "name": "loader",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 2784,
          "end_line": 2784
        },
        {
          "name": "mtmd_init_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd.h",
          "start_line": 96,
          "end_line": 98
        },
        {
          "name": "llama_model_load_from_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 414,
          "end_line": 416
        },
        {
          "name": "llama_model_load_from_splits",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 420,
          "end_line": 423
        },
        {
          "name": "llama_model_save_to_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 425,
          "end_line": 427
        },
        {
          "name": "llama_model_quantize",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 546,
          "end_line": 549
        },
        {
          "name": "llama_adapter_lora_init",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 556,
          "end_line": 558
        },
        {
          "name": "llama_state_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 810,
          "end_line": 815
        },
        {
          "name": "DEPRECATED",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 816,
          "end_line": 822
        },
        {
          "name": "llama_load_session_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 816,
          "end_line": 821
        },
        {
          "name": "llama_state_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 824,
          "end_line": 828
        },
        {
          "name": "DEPRECATED",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 829,
          "end_line": 834
        },
        {
          "name": "llama_save_session_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 829,
          "end_line": 833
        },
        {
          "name": "llama_state_seq_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 858,
          "end_line": 863
        },
        {
          "name": "llama_state_seq_load_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 865,
          "end_line": 871
        },
        {
          "name": "llama_split_path",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 1376,
          "end_line": 1376
        },
        {
          "name": "llama_split_prefix",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 1381,
          "end_line": 1381
        },
        {
          "name": "llama_load_vocab_from_file",
          "type": "function",
          "file_path": "llama/sampling_ext.cpp",
          "start_line": 70,
          "end_line": 70
        },
        {
          "name": "ml",
          "type": "function",
          "file_path": "llama/sampling_ext.cpp",
          "start_line": 75,
          "end_line": 75
        },
        {
          "name": "GetModelArch",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 81,
          "end_line": 101
        },
        {
          "name": "LoadModelFromFile",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 227,
          "end_line": 262
        },
        {
          "name": "ApplyLoraFromFile",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 292,
          "end_line": 310
        },
        {
          "name": "NewMtmdContext",
          "type": "function",
          "file_path": "llama/llama.go",
          "start_line": 480,
          "end_line": 493
        },
        {
          "name": "RefreshFreeMemory",
          "type": "function",
          "file_path": "discover/amd_linux.go",
          "start_line": 483,
          "end_line": 496
        },
        {
          "name": "getFreeMemory",
          "type": "function",
          "file_path": "discover/amd_linux.go",
          "start_line": 498,
          "end_line": 509
        },
        {
          "name": "GetSupportedGFX",
          "type": "function",
          "file_path": "discover/amd_common.go",
          "start_line": 26,
          "end_line": 36
        },
        {
          "name": "commonAMDValidateLibDir",
          "type": "function",
          "file_path": "discover/amd_common.go",
          "start_line": 38,
          "end_line": 83
        },
        {
          "name": "FindGPULibs",
          "type": "function",
          "file_path": "discover/gpu.go",
          "start_line": 509,
          "end_line": 571
        },
        {
          "name": "NewTextProcessor",
          "type": "function",
          "file_path": "model/model.go",
          "start_line": 125,
          "end_line": 136
        },
        {
          "name": "dl_load_library",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 111,
          "end_line": 111
        },
        {
          "name": "dl_load_library",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 144,
          "end_line": 144
        },
        {
          "name": "ggml_backend_registry",
          "type": "class",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 163,
          "end_line": 307
        },
        {
          "name": "ggml_backend_registry.load_backend",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 237,
          "end_line": 237
        },
        {
          "name": "ggml_backend_load",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 411,
          "end_line": 411
        },
        {
          "name": "ggml_backend_load_best",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 498,
          "end_line": 498
        },
        {
          "name": "dir_it",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 524,
          "end_line": 524
        },
        {
          "name": "ggml_backend_load_all_from_path",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml-backend-reg.cpp",
          "start_line": 575,
          "end_line": 575
        },
        {
          "name": "ggml_fopen",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml.c",
          "start_line": 558,
          "end_line": 558
        },
        {
          "name": "ggml_graph_dump_dot",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml.c",
          "start_line": 6733,
          "end_line": 6733
        },
        {
          "name": "gguf_init_from_file",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/gguf.cpp",
          "start_line": 733,
          "end_line": 733
        },
        {
          "name": "gguf_write_to_file",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/gguf.cpp",
          "start_line": 1335,
          "end_line": 1335
        },
        {
          "name": "gguf_init_from_file",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/gguf.h",
          "start_line": 80,
          "end_line": 80
        },
        {
          "name": "gguf_write_to_file",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/gguf.h",
          "start_line": 193,
          "end_line": 193
        },
        {
          "name": "ggml_backend_load",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/ggml-backend.h",
          "start_line": 231,
          "end_line": 231
        },
        {
          "name": "ggml_backend_load_all_from_path",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/ggml-backend.h",
          "start_line": 236,
          "end_line": 236
        },
        {
          "name": "ggml_backend_rpc_start_server",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/ggml-rpc.h",
          "start_line": 23,
          "end_line": 25
        },
        {
          "name": "ggml_fopen",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/ggml.h",
          "start_line": 675,
          "end_line": 675
        },
        {
          "name": "ggml_graph_dump_dot",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/ggml.h",
          "start_line": 2334,
          "end_line": 2334
        },
        {
          "name": "projectorMemoryRequirements",
          "type": "function",
          "file_path": "llm/memory.go",
          "start_line": 483,
          "end_line": 500
        },
        {
          "name": "fileDigestMap",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 142,
          "end_line": 200
        },
        {
          "name": "digestForFile",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 202,
          "end_line": 219
        },
        {
          "name": "filesForModel",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 221,
          "end_line": 310
        },
        {
          "name": "expandPathImpl",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 615,
          "end_line": 650
        },
        {
          "name": "expandPath",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 652,
          "end_line": 654
        },
        {
          "name": "main",
          "type": "function",
          "file_path": "api/examples/multimodal/main.go",
          "start_line": 12,
          "end_line": 47
        },
        {
          "name": "Sign",
          "type": "function",
          "file_path": "auth/auth.go",
          "start_line": 61,
          "end_line": 92
        },
        {
          "name": "normalizeFilePath",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 539,
          "end_line": 557
        },
        {
          "name": "extractFileNames",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 559,
          "end_line": 567
        },
        {
          "name": "extractFileData",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 569,
          "end_line": 589
        },
        {
          "name": "getImageData",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 591,
          "end_line": 633
        },
        {
          "name": "startApp",
          "type": "function",
          "file_path": "cmd/start_darwin.go",
          "start_line": 13,
          "end_line": 31
        },
        {
          "name": "startApp",
          "type": "function",
          "file_path": "cmd/start_windows.go",
          "start_line": 24,
          "end_line": 65
        }
      ],
      "cost": 0.9727960000000095
    },
    {
      "id": "bd1ec518-2837-40a2-ab2d-fc38099b3686",
      "name": "Arbitrary File Write",
      "filter_prompt": "This code snippet involves a file system write operation (such as creating, writing to, or moving a file). The destination path, filename, or the content of the file appears to be constructed or influenced by data originating from an external source (e.g., user input, API request parameters, network data, configuration files, environment variables) and there is no clear evidence of robust sanitization, validation, or restriction of the path to a predefined safe directory.",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "writeStore",
          "type": "function",
          "file_path": "app/store/store.go",
          "start_line": 71,
          "end_line": 97
        },
        {
          "name": "DownloadNewRelease",
          "type": "function",
          "file_path": "app/lifecycle/updater.go",
          "start_line": 107,
          "end_line": 181
        },
        {
          "name": "init",
          "type": "function",
          "file_path": "app/lifecycle/paths.go",
          "start_line": 27,
          "end_line": 84
        },
        {
          "name": "start",
          "type": "function",
          "file_path": "app/lifecycle/server.go",
          "start_line": 52,
          "end_line": 132
        },
        {
          "name": "iconBytesToFilePath",
          "type": "function",
          "file_path": "app/tray/wintray/tray.go",
          "start_line": 413,
          "end_line": 424
        },
        {
          "name": "UpdateAvailable",
          "type": "function",
          "file_path": "app/tray/wintray/menus.go",
          "start_line": 36,
          "end_line": 72
        },
        {
          "name": "install",
          "type": "function",
          "file_path": "macapp/src/install.ts",
          "start_line": 15,
          "end_line": 21
        },
        {
          "name": "WriteTo",
          "type": "function",
          "file_path": "convert/reader_safetensors.go",
          "start_line": 121,
          "end_line": 205
        },
        {
          "name": "ConvertAdapter",
          "type": "function",
          "file_path": "convert/convert.go",
          "start_line": 118,
          "end_line": 154
        },
        {
          "name": "Add",
          "type": "function",
          "file_path": "readline/history.go",
          "start_line": 83,
          "end_line": 90
        },
        {
          "name": "Save",
          "type": "function",
          "file_path": "readline/history.go",
          "start_line": 125,
          "end_line": 151
        },
        {
          "name": "CopyModel",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 375,
          "end_line": 412
        },
        {
          "name": "deleteUnusedLayers",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 414,
          "end_line": 443
        },
        {
          "name": "PruneLayers",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 445,
          "end_line": 487
        },
        {
          "name": "PruneDirectory",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 489,
          "end_line": 520
        },
        {
          "name": "PullModel",
          "type": "function",
          "file_path": "server/images.go",
          "start_line": 571,
          "end_line": 675
        },
        {
          "name": "createModel",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 319,
          "end_line": 424
        },
        {
          "name": "quantizeLayer",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 426,
          "end_line": 476
        },
        {
          "name": "setTemplate",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 543,
          "end_line": 560
        },
        {
          "name": "setSystem",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 562,
          "end_line": 573
        },
        {
          "name": "setLicense",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 575,
          "end_line": 583
        },
        {
          "name": "setParameters",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 585,
          "end_line": 634
        },
        {
          "name": "setMessages",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 636,
          "end_line": 655
        },
        {
          "name": "createConfigLayer",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 657,
          "end_line": 673
        },
        {
          "name": "createLink",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 675,
          "end_line": 688
        },
        {
          "name": "copyFile",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 690,
          "end_line": 705
        },
        {
          "name": "GetManifestPath",
          "type": "function",
          "file_path": "server/modelpath.go",
          "start_line": 116,
          "end_line": 123
        },
        {
          "name": "Remove",
          "type": "function",
          "file_path": "server/manifest.go",
          "start_line": 36,
          "end_line": 47
        },
        {
          "name": "RemoveLayers",
          "type": "function",
          "file_path": "server/manifest.go",
          "start_line": 49,
          "end_line": 61
        },
        {
          "name": "WriteManifest",
          "type": "function",
          "file_path": "server/manifest.go",
          "start_line": 99,
          "end_line": 124
        },
        {
          "name": "Name",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 103,
          "end_line": 107
        },
        {
          "name": "Prepare",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 126,
          "end_line": 181
        },
        {
          "name": "run",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 214,
          "end_line": 327
        },
        {
          "name": "newPart",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 390,
          "end_line": 398
        },
        {
          "name": "readPart",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 400,
          "end_line": 414
        },
        {
          "name": "writePart",
          "type": "function",
          "file_path": "server/download.go",
          "start_line": 416,
          "end_line": 424
        },
        {
          "name": "NewLayer",
          "type": "function",
          "file_path": "server/layer.go",
          "start_line": 19,
          "end_line": 65
        },
        {
          "name": "common_log",
          "type": "class",
          "file_path": "llama/llama.cpp/common/log.cpp",
          "start_line": 108,
          "end_line": 344
        },
        {
          "name": "common_log.set_file",
          "type": "function",
          "file_path": "llama/llama.cpp/common/log.cpp",
          "start_line": 295,
          "end_line": 295
        },
        {
          "name": "common_log_set_file",
          "type": "function",
          "file_path": "llama/llama.cpp/common/log.cpp",
          "start_line": 379,
          "end_line": 379
        },
        {
          "name": "fs_create_directory_with_parents",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.h",
          "start_line": 565,
          "end_line": 565
        },
        {
          "name": "state_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 1732,
          "end_line": 1732
        },
        {
          "name": "state_seq_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 1792,
          "end_line": 1792
        },
        {
          "name": "llama_save_session_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2757,
          "end_line": 2757
        },
        {
          "name": "llama_state_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2791,
          "end_line": 2791
        },
        {
          "name": "llama_state_seq_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-context.cpp",
          "start_line": 2818,
          "end_line": 2818
        },
        {
          "name": "llama_model_quantize",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-quant.cpp",
          "start_line": 1073,
          "end_line": 1076
        },
        {
          "name": "llama_model_save_to_file",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama.cpp",
          "start_line": 266,
          "end_line": 266
        },
        {
          "name": "save",
          "type": "function",
          "file_path": "llama/llama.cpp/src/llama-model-saver.cpp",
          "start_line": 279,
          "end_line": 279
        },
        {
          "name": "llama_context",
          "type": "class",
          "file_path": "llama/llama.cpp/src/llama-context.h",
          "start_line": 23,
          "end_line": 310
        },
        {
          "name": "llama_model_saver",
          "type": "class",
          "file_path": "llama/llama.cpp/src/llama-model-saver.h",
          "start_line": 8,
          "end_line": 37
        },
        {
          "name": "clip_image_write_image_to_ppm",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 61,
          "end_line": 61
        },
        {
          "name": "file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 62,
          "end_line": 62
        },
        {
          "name": "clip_image_save_to_bmp",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 80,
          "end_line": 80
        },
        {
          "name": "file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/clip.cpp",
          "start_line": 81,
          "end_line": 81
        },
        {
          "name": "llama_model_save_to_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 425,
          "end_line": 427
        },
        {
          "name": "llama_model_quantize",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 546,
          "end_line": 549
        },
        {
          "name": "llama_state_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 824,
          "end_line": 828
        },
        {
          "name": "DEPRECATED",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 829,
          "end_line": 834
        },
        {
          "name": "llama_save_session_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 829,
          "end_line": 833
        },
        {
          "name": "llama_state_seq_save_file",
          "type": "function",
          "file_path": "llama/llama.cpp/include/llama.h",
          "start_line": 858,
          "end_line": 863
        },
        {
          "name": "ggml_graph_dump_dot",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/ggml.c",
          "start_line": 6733,
          "end_line": 6733
        },
        {
          "name": "gguf_write_to_file",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/src/gguf.cpp",
          "start_line": 1335,
          "end_line": 1335
        },
        {
          "name": "gguf_write_to_file",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/gguf.h",
          "start_line": 193,
          "end_line": 193
        },
        {
          "name": "ggml_graph_dump_dot",
          "type": "function",
          "file_path": "ml/backend/ggml/ggml/include/ggml.h",
          "start_line": 2334,
          "end_line": 2334
        },
        {
          "name": "Write",
          "type": "function",
          "file_path": "llm/status.go",
          "start_line": 33,
          "end_line": 45
        }
      ],
      "cost": 0.9767231999999995
    },
    {
      "id": "50794dd5-45fd-43e4-afd3-37359ef5b076",
      "name": "Bypass of File Extension Restrictions",
      "filter_prompt": "This code snippet is involved in processing files uploaded by users. This includes operations such as retrieving the original filename or file extension, determining the destination path or filename for storage, moving or saving the uploaded file to the server's filesystem, and/or implementing validation rules to restrict allowed file types. These validation rules might be based on the file's extension (e.g., checking against a list of permitted or forbidden extensions like '.php', '.jsp', '.asp', '.exe', '.gif', '.jpg'), its MIME type, or its initial bytes (magic bytes/file signatures).",
      "subdirs_or_files": [
        "/"
      ],
      "snippets": [
        {
          "name": "DetectContentType",
          "type": "function",
          "file_path": "fs/ggml/ggml.go",
          "start_line": 427,
          "end_line": 442
        },
        {
          "name": "CreateHandler",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 41,
          "end_line": 155
        },
        {
          "name": "convertModelFromFiles",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 157,
          "end_line": 187
        },
        {
          "name": "detectModelTypeFromFiles",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 189,
          "end_line": 225
        },
        {
          "name": "convertFromSafetensors",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 227,
          "end_line": 308
        },
        {
          "name": "ggufLayers",
          "type": "function",
          "file_path": "server/create.go",
          "start_line": 478,
          "end_line": 526
        },
        {
          "name": "detectContentType",
          "type": "function",
          "file_path": "server/model.go",
          "start_line": 112,
          "end_line": 127
        },
        {
          "name": "fs_validate_filename",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.cpp",
          "start_line": 700,
          "end_line": 700
        },
        {
          "name": "fs_validate_filename",
          "type": "function",
          "file_path": "llama/llama.cpp/common/common.h",
          "start_line": 564,
          "end_line": 564
        },
        {
          "name": "is_audio_file",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd-helper.cpp",
          "start_line": 349,
          "end_line": 349
        },
        {
          "name": "decode_audio_from_buf",
          "type": "function",
          "file_path": "llama/llama.cpp/tools/mtmd/mtmd-helper.cpp",
          "start_line": 368,
          "end_line": 368
        },
        {
          "name": "fileDigestMap",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 142,
          "end_line": 200
        },
        {
          "name": "filesForModel",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 221,
          "end_line": 310
        },
        {
          "name": "expandPathImpl",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 615,
          "end_line": 650
        },
        {
          "name": "expandPath",
          "type": "function",
          "file_path": "parser/parser.go",
          "start_line": 652,
          "end_line": 654
        },
        {
          "name": "extractFileNames",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 559,
          "end_line": 567
        },
        {
          "name": "extractFileData",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 569,
          "end_line": 589
        },
        {
          "name": "getImageData",
          "type": "function",
          "file_path": "cmd/interactive.go",
          "start_line": 591,
          "end_line": 633
        },
        {
          "name": "path",
          "type": "dependency",
          "file_path": "macapp/src/index.ts",
          "start_line": 6,
          "end_line": 6
        },
        {
          "name": "fs",
          "type": "dependency",
          "file_path": "macapp/src/install.ts",
          "start_line": 1,
          "end_line": 1
        },
        {
          "name": "path",
          "type": "dependency",
          "file_path": "macapp/src/install.ts",
          "start_line": 3,
          "end_line": 3
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "fs/ggml/gguf.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "fs/ggml/gguf.go",
          "start_line": 15,
          "end_line": 15
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "fs/ggml/ggml.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "fs/ggml/type.go",
          "start_line": 6,
          "end_line": 6
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "fs/gguf/gguf.go",
          "start_line": 11,
          "end_line": 11
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "fs/gguf/gguf.go",
          "start_line": 13,
          "end_line": 13
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "fs/gguf/tensor.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "convert/convert_llama4.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "convert/convert_llama_adapter.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "io/fs",
          "type": "dependency",
          "file_path": "convert/convert_bert.go",
          "start_line": 6,
          "end_line": 6
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "convert/convert_bert.go",
          "start_line": 7,
          "end_line": 7
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "convert/convert_bert.go",
          "start_line": 9,
          "end_line": 9
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "convert/convert_llama.go",
          "start_line": 7,
          "end_line": 7
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "runner/ollamarunner/runner.go",
          "start_line": 16,
          "end_line": 16
        },
        {
          "name": "net/http",
          "type": "dependency",
          "file_path": "runner/ollamarunner/runner.go",
          "start_line": 15,
          "end_line": 15
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "server/images.go",
          "start_line": 17,
          "end_line": 17
        },
        {
          "name": "io",
          "type": "dependency",
          "file_path": "server/images.go",
          "start_line": 11,
          "end_line": 11
        },
        {
          "name": "net/http",
          "type": "dependency",
          "file_path": "server/images.go",
          "start_line": 15,
          "end_line": 15
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/images.go",
          "start_line": 18,
          "end_line": 18
        },
        {
          "name": "io/fs",
          "type": "dependency",
          "file_path": "server/routes.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "net/http",
          "type": "dependency",
          "file_path": "server/routes.go",
          "start_line": 16,
          "end_line": 16
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "server/routes.go",
          "start_line": 18,
          "end_line": 18
        },
        {
          "name": "github.com/gin-gonic/gin",
          "type": "dependency",
          "file_path": "server/routes.go",
          "start_line": 26,
          "end_line": 26
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "server/sched.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/create.go",
          "start_line": 15,
          "end_line": 15
        },
        {
          "name": "github.com/gin-gonic/gin",
          "type": "dependency",
          "file_path": "server/create.go",
          "start_line": 20,
          "end_line": 20
        },
        {
          "name": "net/http",
          "type": "dependency",
          "file_path": "server/create.go",
          "start_line": 13,
          "end_line": 13
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "server/create.go",
          "start_line": 14,
          "end_line": 14
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "server/fixblobs.go",
          "start_line": 4,
          "end_line": 4
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/fixblobs.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "server/sparse_common.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "server/modelpath.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/modelpath.go",
          "start_line": 9,
          "end_line": 9
        },
        {
          "name": "regexp",
          "type": "dependency",
          "file_path": "server/modelpath.go",
          "start_line": 10,
          "end_line": 10
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/manifest.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/internal/cache/blob/cache.go",
          "start_line": 15,
          "end_line": 15
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/internal/testutil/testutil.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/internal/client/ollama/registry.go",
          "start_line": 26,
          "end_line": 26
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "server/download.go",
          "start_line": 15,
          "end_line": 15
        },
        {
          "name": "experimental/filesystem",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 4796,
          "end_line": 4796
        },
        {
          "name": "string",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 30,
          "end_line": 30
        },
        {
          "name": "string",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 3501,
          "end_line": 3501
        },
        {
          "name": "string",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 6435,
          "end_line": 6435
        },
        {
          "name": "string",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 9655,
          "end_line": 9655
        },
        {
          "name": "string",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 14519,
          "end_line": 14519
        },
        {
          "name": "string",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 7011,
          "end_line": 7011
        },
        {
          "name": "string",
          "type": "dependency",
          "file_path": "llama/llama.cpp/vendor/nlohmann/json.hpp",
          "start_line": 15606,
          "end_line": 15606
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "discover/path.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "discover/amd_linux.go",
          "start_line": 10,
          "end_line": 10
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "discover/amd_linux.go",
          "start_line": 11,
          "end_line": 11
        },
        {
          "name": "regexp",
          "type": "dependency",
          "file_path": "discover/amd_linux.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "discover/amd_linux.go",
          "start_line": 16,
          "end_line": 16
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "discover/amd_common.go",
          "start_line": 9,
          "end_line": 9
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "discover/amd_common.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "discover/amd_common.go",
          "start_line": 11,
          "end_line": 11
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "discover/gpu.go",
          "start_line": 16,
          "end_line": 16
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "discover/gpu.go",
          "start_line": 17,
          "end_line": 17
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "discover/gpu.go",
          "start_line": 20,
          "end_line": 20
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "discover/cuda_common.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "regexp",
          "type": "dependency",
          "file_path": "discover/cuda_common.go",
          "start_line": 9,
          "end_line": 9
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "discover/cuda_common.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "discover/cpu_common.go",
          "start_line": 4,
          "end_line": 4
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "discover/cpu_common.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "discover/cpu_common.go",
          "start_line": 7,
          "end_line": 7
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "logutil/logutil.go",
          "start_line": 6,
          "end_line": 6
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "model/bytepairencoding.go",
          "start_line": 9,
          "end_line": 9
        },
        {
          "name": "github.com/dlclark/regexp2",
          "type": "dependency",
          "file_path": "model/bytepairencoding.go",
          "start_line": 11,
          "end_line": 11
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "model/sentencepiece.go",
          "start_line": 9,
          "end_line": 9
        },
        {
          "name": "github.com/ollama/ollama/fs",
          "type": "dependency",
          "file_path": "model/models/llama4/process_image.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "github.com/ollama/ollama/fs",
          "type": "dependency",
          "file_path": "model/models/gptoss/model.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "model/models/gptoss/model.go",
          "start_line": 6,
          "end_line": 6
        },
        {
          "name": "github.com/ollama/ollama/fs",
          "type": "dependency",
          "file_path": "model/models/qwen3/model.go",
          "start_line": 7,
          "end_line": 7
        },
        {
          "name": "bytes",
          "type": "dependency",
          "file_path": "tools/tools.go",
          "start_line": 4,
          "end_line": 4
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "tools/tools.go",
          "start_line": 6,
          "end_line": 6
        },
        {
          "name": "bytes",
          "type": "dependency",
          "file_path": "tools/template.go",
          "start_line": 4,
          "end_line": 4
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "tools/template.go",
          "start_line": 7,
          "end_line": 7
        },
        {
          "name": "io",
          "type": "dependency",
          "file_path": "ml/backend/ggml/ggml.go",
          "start_line": 15,
          "end_line": 15
        },
        {
          "name": "github.com/ollama/ollama/fs",
          "type": "dependency",
          "file_path": "ml/backend/ggml/ggml.go",
          "start_line": 29,
          "end_line": 29
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "ml/backend/ggml/ggml.go",
          "start_line": 18,
          "end_line": 18
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "ml/backend/ggml/ggml.go",
          "start_line": 22,
          "end_line": 22
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "api/examples/multimodal/main.go",
          "start_line": 7,
          "end_line": 7
        },
        {
          "name": "io",
          "type": "dependency",
          "file_path": "auth/auth.go",
          "start_line": 10,
          "end_line": 10
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "auth/auth.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "auth/auth.go",
          "start_line": 13,
          "end_line": 13
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "types/model/name.go",
          "start_line": 10,
          "end_line": 10
        },
        {
          "name": "io",
          "type": "dependency",
          "file_path": "cmd/interactive.go",
          "start_line": 7,
          "end_line": 7
        },
        {
          "name": "net/http",
          "type": "dependency",
          "file_path": "cmd/interactive.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "cmd/interactive.go",
          "start_line": 9,
          "end_line": 9
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "cmd/interactive.go",
          "start_line": 10,
          "end_line": 10
        },
        {
          "name": "regexp",
          "type": "dependency",
          "file_path": "cmd/interactive.go",
          "start_line": 11,
          "end_line": 11
        },
        {
          "name": "regexp",
          "type": "dependency",
          "file_path": "cmd/start_darwin.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "cmd/start_darwin.go",
          "start_line": 6,
          "end_line": 6
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "cmd/runner/main.go",
          "start_line": 5,
          "end_line": 5
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "cmd/cmd.go",
          "start_line": 17,
          "end_line": 17
        },
        {
          "name": "bufio",
          "type": "dependency",
          "file_path": "cmd/cmd.go",
          "start_line": 4,
          "end_line": 4
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "cmd/cmd.go",
          "start_line": 19,
          "end_line": 19
        },
        {
          "name": "io",
          "type": "dependency",
          "file_path": "cmd/cmd.go",
          "start_line": 12,
          "end_line": 12
        },
        {
          "name": "os",
          "type": "dependency",
          "file_path": "cmd/start_windows.go",
          "start_line": 8,
          "end_line": 8
        },
        {
          "name": "path",
          "type": "dependency",
          "file_path": "cmd/start_windows.go",
          "start_line": 10,
          "end_line": 10
        },
        {
          "name": "path/filepath",
          "type": "dependency",
          "file_path": "cmd/start_windows.go",
          "start_line": 11,
          "end_line": 11
        },
        {
          "name": "strings",
          "type": "dependency",
          "file_path": "cmd/start_windows.go",
          "start_line": 12,
          "end_line": 12
        }
      ],
      "cost": 0.9001720000000066
    }
  ]
}